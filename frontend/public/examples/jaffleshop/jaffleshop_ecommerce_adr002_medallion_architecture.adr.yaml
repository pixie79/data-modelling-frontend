id: 635103fe-6ebc-4b35-ab5c-2dd99005045c
number: 2
title: Adopt Medallion Architecture for Data Layers
status: accepted
category: architecture
context: |
  As Jaffleshop's data platform grows, we need a consistent approach
  to organizing data transformations. The current ad-hoc approach leads to:

  - Confusion about which tables are "source of truth"
  - Duplicate transformations across different pipelines
  - Difficulty in debugging data quality issues
  - Unclear ownership of data assets

  We need a layered architecture that provides clear separation of
  concerns and enables incremental processing.

decision: |
  We will adopt the Medallion Architecture pattern with three layers:

  1. **Bronze (Raw):** Immutable landing zone for source data
     - Tables prefixed with `raw_`
     - No transformations, schema matches source
     - Full history retained

  2. **Silver (Staging):** Cleaned and validated data
     - Tables prefixed with `stg_`
     - Data quality rules applied
     - Deduplication and standardization

  3. **Gold (Marts):** Business-ready dimensional models
     - No prefix, business-friendly names
     - Star schema design
     - Optimized for analytics

consequences: |
  **Positive:**
  - Clear data lineage from source to consumption
  - Easier debugging with layer isolation
  - Reusable staging layer across multiple marts
  - Consistent naming conventions
  - Incremental processing support

  **Negative:**
  - More storage due to data duplication
  - Additional processing steps increase latency
  - Learning curve for new team members

  **Mitigations:**
  - Use incremental models to reduce processing time
  - Document layer responsibilities clearly
  - Implement storage lifecycle policies
  - Provide training on medallion architecture

options:
  - title: Medallion Architecture (Selected)
    description: Three-layer architecture (Bronze/Silver/Gold)
    pros:
      - Industry standard pattern
      - Clear separation of concerns
      - Supports incremental processing
      - Easy to understand and maintain
    cons:
      - Storage overhead
      - Processing latency
  - title: Lambda Architecture
    description: Separate batch and real-time paths
    pros:
      - Real-time capabilities
      - Handles late-arriving data
    cons:
      - Complex to maintain
      - Code duplication
      - Higher operational overhead
  - title: Kappa Architecture
    description: Stream-only processing
    pros:
      - Simpler than Lambda
      - Single processing path
    cons:
      - Requires streaming infrastructure
      - Reprocessing challenges
      - Higher cost for batch workloads

domain_id: d9004c83-fd63-43fe-afb8-77726c3e276e
workspace_id: f47ac10b-58cc-4372-a567-0e02b2c3d479
authors:
  - data-architecture-team@jaffleshop.example
deciders:
  - head-of-data@jaffleshop.example
consulted:
  - data-engineering@jaffleshop.example
  - analytics@jaffleshop.example
informed:
  - all-engineering@jaffleshop.example
related_decisions:
  - bc9a9569-a8d8-430a-8df3-0af171f2d2eb
related_knowledge:
  - 82ab7dc8-e596-419c-9a8e-c91fe84b5c7e
tags:
  - name: architecture
  - name: medallion
  - name: data-layers
  - name: patterns
created_at: '2024-01-11T14:00:00Z'
updated_at: '2024-01-11T14:00:00Z'
decided_at: '2024-01-11T14:00:00Z'
