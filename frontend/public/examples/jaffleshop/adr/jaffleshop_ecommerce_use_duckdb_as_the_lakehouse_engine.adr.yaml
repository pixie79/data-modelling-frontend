id: bc9a9569-a8d8-430a-8df3-0af171f2d2eb
number: 2401101100
title: Use DuckDB as the Lakehouse Engine
status: accepted
category: technology
context: |
  Jaffleshop needs a data lakehouse solution to support analytics workloads.
  The solution must:
  - Handle both batch and interactive queries efficiently
  - Support standard SQL syntax
  - Integrate with dbt for transformations
  - Be cost-effective for a growing business
  - Support local development without cloud infrastructure

  We evaluated several options including Snowflake, Databricks, BigQuery,
  and DuckDB. Each has different trade-offs in terms of cost, complexity,
  and capabilities.
decision: |
  We will use DuckDB as the primary lakehouse engine for the Jaffleshop
  data platform.

  DuckDB is an embedded analytical database that:
  - Runs in-process with zero external dependencies
  - Provides excellent performance for OLAP workloads
  - Supports full SQL with window functions, CTEs, etc.
  - Has native dbt integration via dbt-duckdb adapter
  - Enables local development without cloud costs
  - Can read/write Parquet files directly
consequences: |
  **Positive:**
  - Zero infrastructure cost for development and testing
  - Fast iteration cycles with in-process execution
  - Easy onboarding for new developers
  - Full SQL compatibility with other databases
  - Excellent performance for datasets up to 100GB
  - Native support for data lake file formats

  **Negative:**
  - May need migration to cloud data warehouse at scale
  - Limited to single-node processing
  - No built-in data sharing features
  - Community support vs enterprise support

  **Mitigations:**
  - Design for portability to Snowflake/BigQuery
  - Monitor data volumes for scaling triggers
  - Document migration path in runbooks
options:
  - name: DuckDB
    description: Embedded analytical database, runs in-process
    pros:
      - Zero infrastructure cost
      - Fast local development
      - dbt integration
      - Parquet native support
    cons:
      - Single-node only
      - May not scale beyond 100GB efficiently
    selected: true
  - name: Snowflake
    description: Cloud-native data warehouse
    pros:
      - Infinite scalability
      - Enterprise features
      - Strong ecosystem
    cons:
      - Pay-per-use costs
      - Requires cloud setup
      - Slower local development
    selected: false
  - name: BigQuery
    description: Google Cloud serverless data warehouse
    pros:
      - Serverless architecture
      - Pay-per-query pricing
      - ML integration
    cons:
      - GCP lock-in
      - Cold start latency
      - Complex cost management
    selected: false
domainId: d9004c83-fd63-43fe-afb8-77726c3e276e
workspaceId: f47ac10b-58cc-4372-a567-0e02b2c3d479
authors:
  - platform-team@jaffleshop.example
deciders:
  - cto@jaffleshop.example
  - head-of-data@jaffleshop.example
tags:
  - technology
  - database
  - lakehouse
  - infrastructure
createdAt: '2026-01-11T15:39:33.874Z'
updatedAt: '2026-01-11T15:39:33.874Z'
decidedAt: '2024-01-10T11:00:00Z'
